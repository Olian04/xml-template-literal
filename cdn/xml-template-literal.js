!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).xmlTemplateLiteral={})}(this,(function(e){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)};function n(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function r(e,t){var n,r,a,u,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return u={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function i(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,i[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){c.label=i[1];break}if(6===i[0]&&c.label<a[1]){c.label=a[1],a=i;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(i);break}a[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,u=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=u.next()).done;)c.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=u.return)&&n.call(u)}finally{if(a)throw a.error}}return c}function c(e,t,n){if(n||2===arguments.length)for(var r,a=0,u=t.length;a<u;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}var i=function(e){function t(t){return e.call(this,"UnexpectedEOF".concat(t?" near: ".concat(t):""))||this}return n(t,e),t}(Error),o=function(e){function t(t,n){return e.call(this,'UnexpectedToken: Expected "'.concat(t,'" but got "').concat(n,'"'))||this}return n(t,e),t}(Error),l=function(e,t,n){if(n[e]!==t)throw new o(t,String(n[e]))},s=function(e,t){if("Syntax"!==t.kind||t.value!==e)throw new o(e,String(t.value))},f=function(e){for(;"Whitespace"===e.current.kind;)e.next()},v=function(e,t){void 0===t&&(t=!0),e.next(),t&&f(e)},d=function(e){l("kind","Text",e.current);var t=e.current.value;return v(e),s("=",e.current),v(e),"Data"===e.current.kind?{kind:"Attribute",type:"Data",key:t,value:e.current.value}:(s('"',e.current),v(e),function(e,t){for(var n=[],r="";'"'!==t.current.value;)"Data"===t.current.kind?(r.length>0&&(n.push({kind:"Composite",type:"Text",value:r}),r=""),n.push({kind:"Composite",type:"Data",value:t.current.value})):r+=t.current.value,v(t);return s('"',t.current),n.length>0?(n.push({kind:"Composite",type:"Text",value:r}),{kind:"Attribute",type:"Composite",key:e,value:n}):{kind:"Attribute",type:"Text",key:e,value:r}}(t,e))},p=function(e){return"Data"===e.current.kind?{kind:"Child",type:"Data",value:e.current.value}:"Text"===e.current.kind?{kind:"Child",type:"Text",value:e.current.value}:function(e){s("<",e.current),v(e),l("kind","Text",e.current);var t=e.current.value;v(e);for(var n=[];"Text"===e.current.kind;)n.push(d(e)),v(e);if("/>"===e.current.value)return s("/>",e.current),v(e),{kind:"Child",type:"Node",tag:t,attributes:n,children:[]};s(">",e.current),v(e);for(var r=[];"</"!==e.current.value;)r.push(p(e)),v(e);return s("</",e.current),v(e),l("value",t,e.current),v(e),s(">",e.current),{kind:"Child",type:"Node",tag:t,attributes:n,children:r}}(e)},y=function(e){var t,n,r,a,u=(t=e,n={},r=function(){return"next"in n||(n.next=t.next()),n.next},a={next:function(){n.previous=n.next,delete n.next,r()},get done(){return Boolean(r().done)},get current(){var e,t,u,c;if(a.done)throw"previous"in n&&"next"in n?new i("".concat(null===(t=null===(e=n.previous)||void 0===e?void 0:e.value)||void 0===t?void 0:t.value)):"next"in n?new i("".concat(null===(c=null===(u=n.next)||void 0===u?void 0:u.value)||void 0===c?void 0:c.value)):new i;return r().value}});return f(u),p(u)};function h(e){var t,n,a;return r(this,(function(r){switch(r.label){case 0:n=void 0,a=void 0,r.label=1;case 1:return(t=e.next()).done?[3,8]:(a=n,n=t.value,"Syntax"!==(null==a?void 0:a.kind)||"Syntax"!==n.kind?[3,5]:"<"!==a.value||"/"!==n.value?[3,3]:[4,{kind:"Syntax",value:"</"}]);case 2:return r.sent(),n=void 0,[3,1];case 3:return"/"!==a.value||">"!==n.value?[3,5]:[4,{kind:"Syntax",value:"/>"}];case 4:return r.sent(),n=void 0,[3,1];case 5:return a?[4,a]:[3,7];case 6:r.sent(),r.label=7;case 7:return[3,1];case 8:return n?[4,n]:[3,10];case 9:r.sent(),r.label=10;case 10:return[2]}}))}function x(e){var t,n,u,c,i,o,l;return r(this,(function(r){switch(r.label){case 0:t="",r.label=1;case 1:r.trys.push([1,9,10,11]),n=a(e),u=n.next(),r.label=2;case 2:return u.done?[3,8]:"Text"===(c=u.value).kind?[3,6]:t?[4,{kind:"Text",value:t}]:[3,4];case 3:r.sent(),t="",r.label=4;case 4:return[4,c];case 5:return r.sent(),[3,7];case 6:t+=c.value,r.label=7;case 7:return u=n.next(),[3,2];case 8:return[3,11];case 9:return i=r.sent(),o={error:i},[3,11];case 10:try{u&&!u.done&&(l=n.return)&&l.call(n)}finally{if(o)throw o.error}return[7];case 11:return t?[4,{kind:"Text",value:t}]:[3,13];case 12:r.sent(),r.label=13;case 13:return[2]}}))}function b(e){var t,n,u,c,i,o;return r(this,(function(r){switch(r.label){case 0:r.trys.push([0,24,25,26]),t=a(e),n=t.next(),r.label=1;case 1:if(n.done)return[3,23];switch(u=n.value,u){case"<":return[3,2];case">":return[3,4];case"/":return[3,6];case"=":return[3,8];case'"':return[3,10];case"\n":return[3,12];case"\r":return[3,14];case"\t":return[3,16];case" ":return[3,18]}return[3,20];case 2:return[4,{kind:"Syntax",value:"<"}];case 3:return r.sent(),[3,22];case 4:return[4,{kind:"Syntax",value:">"}];case 5:return r.sent(),[3,22];case 6:return[4,{kind:"Syntax",value:"/"}];case 7:return r.sent(),[3,22];case 8:return[4,{kind:"Syntax",value:"="}];case 9:return r.sent(),[3,22];case 10:return[4,{kind:"Syntax",value:'"'}];case 11:return r.sent(),[3,22];case 12:return[4,{kind:"Whitespace",value:"\n"}];case 13:return r.sent(),[3,22];case 14:return[4,{kind:"Whitespace",value:"\r"}];case 15:return r.sent(),[3,22];case 16:return[4,{kind:"Whitespace",value:"\t"}];case 17:return r.sent(),[3,22];case 18:return[4,{kind:"Whitespace",value:" "}];case 19:return r.sent(),[3,22];case 20:return[4,{kind:"Text",value:u}];case 21:return r.sent(),[3,22];case 22:return n=t.next(),[3,1];case 23:return[3,26];case 24:return c=r.sent(),i={error:c},[3,26];case 25:try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(i)throw i.error}return[7];case 26:return[2]}}))}function k(e){var t,n,u,c,i,o;return r(this,(function(r){switch(r.label){case 0:r.trys.push([0,8,9,10]),t=a(e),n=t.next(),r.label=1;case 1:return n.done?[3,7]:"Static"!==(u=n.value).type?[3,3]:[5,a(h(x(b(u.value))))];case 2:return r.sent(),[3,6];case 3:return"Dynamic"!==u.type?[3,5]:[4,{kind:"Data",value:u.value}];case 4:return r.sent(),[3,6];case 5:throw new Error("Unknown segment: ".concat(u));case 6:return n=t.next(),[3,1];case 7:return[3,10];case 8:return c=r.sent(),i={error:c},[3,10];case 9:try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(i)throw i.error}return[7];case 10:return[2]}}))}var w=function(e){return new Array(e.static.length+e.dynamic.length).fill(0).map((function(t,n){return n%2==0?{type:"Static",value:e.static[Math.floor(n/2)]}:{type:"Dynamic",value:e.dynamic[Math.floor(n/2)]}})).filter((function(e){return Boolean(e.value)}))};e.parseXml=function(e){return y(k("string"==typeof e?w({dynamic:[],static:[e]}):e))},e.xml=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return y(k(w({dynamic:t,static:c([],u(e),!1)})))}}));
